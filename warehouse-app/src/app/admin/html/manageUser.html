<main>
  <header>
    <h1>User List</h1>
    <span>Managing users' information and roles</span>
  </header>

  <div class="message" *ngIf="message">{{ message }}</div>
  <div class="err" *ngIf="error">{{ error }}</div>

  <div class="content-box">
    <table>
      <tr class="table-head">
        <th>Name</th>
        <th>Email</th>
        <th>Phone</th>
        <th>Created On</th>
        <th>Role</th>
        <th></th>
      </tr>

      <tr *ngFor="let user of users">
        <td>{{ user.name }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.phoneNumber }}</td>
        <td>{{ user.createdAt | date: 'short' }}</td>
        <td>{{ user.role }}</td>

        <td class="actions">
          <button class="edit" (click)="openEditUserModal(user)">Edit</button>
          <button class="delete" (click)="deleteUser(user.id)">Delete</button>
        </td>
      </tr>
    </table>
  </div>

  <!-- GLOBAL EDIT MODAL -->
  <div class="modal-background" *ngIf="showEditUserForm">
    <form class="modal" [formGroup]="editUserForm" (ngSubmit)="editUser(selectedUser.id)">

      <h2>Edit User</h2>

      <label>Name</label>
      <input type="text" formControlName="name" />

      <label>Email</label>
      <div class="readonly-field">{{ selectedUser.email }}</div>

      <label>Phone</label>
      <input type="text" formControlName="phone" />

      <label>Role</label>
      <div class="readonly-field">{{ selectedUser.role }}</div>

      <label>Created At</label>
      <div class="readonly-field">{{ selectedUser.createdAt | date:'short' }}</div>

      <div class="modal-controls">
        <button type="button" class="btn-cancel" (click)="closeModal()">Cancel</button>
        <button type="submit" class="btn-save">Save</button>
      </div>

    </form>
  </div>
</main>